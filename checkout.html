<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkout - Amor Conect</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://sdk.mercadopago.com/js/v2"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }


    :root {
      --bege: #f6ecc5;
      --vermelho-rosado: #d1656d;
      --lilas: #dfc9ed;
      --branco: #ffffff;
      --text: #444;
      --text-light: #666;
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      --transition: all 0.3s ease;
    }


    body {
      background-color: var(--bege);
      color: var(--text);
      line-height: 1.6;
    }


    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }


    /* Header */
    header {
      background: linear-gradient(135deg, var(--vermelho-rosado), var(--lilas));
      color: var(--branco);
      padding: 1rem 0;
      box-shadow: var(--shadow);
      position: sticky;
      top: 0;
      z-index: 100;
    }


    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }


    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }


    .logo img {
      height: 80px;
      width: auto;
      object-fit: contain;
    }


    .logo h1 {
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--branco);
    }


    .btn {
      padding: 0.8rem 2rem;
      border-radius: 30px;
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      text-decoration: none;
      display: inline-block;
      text-align: center;
      font-size: 1rem;
    }


    .btn-outline {
      background: transparent;
      border: 2px solid var(--branco);
      color: var(--branco);
    }


    .btn-primary {
      background: var(--vermelho-rosado);
      color: var(--branco);
      border: none;
    }


    .btn-secondary {
      background: transparent;
      border: 2px solid var(--vermelho-rosado);
      color: var(--vermelho-rosado);
    }


    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }


    /* Main Content */
    .main-content {
      padding: 3rem 0;
      min-height: calc(100vh - 200px);
    }


    .checkout-grid {
      display: grid;
      grid-template-columns: 1fr 400px;
      gap: 3rem;
      align-items: start;
    }


    @media (max-width: 968px) {
      .checkout-grid {
        grid-template-columns: 1fr;
      }
    }


    /* Order Summary */
    .order-summary {
      background: var(--branco);
      border-radius: 20px;
      padding: 2.5rem;
      box-shadow: var(--shadow);
      border: 1px solid var(--lilas);
    }


    .section-title {
      font-size: 1.8rem;
      color: var(--vermelho-rosado);
      margin-bottom: 2rem;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }


    .plan-selected {
      background: linear-gradient(135deg, var(--lilas), var(--bege));
      padding: 2rem;
      border-radius: 15px;
      margin-bottom: 2rem;
      text-align: center;
      border: 2px solid var(--lilas);
    }


    .plan-name {
      font-size: 1.6rem;
      color: var(--vermelho-rosado);
      margin-bottom: 0.5rem;
      font-weight: 700;
    }


    .plan-price {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 0.5rem;
      color: var(--text);
    }


    .plan-period {
      color: var(--text-light);
      font-size: 1.1rem;
    }


    .benefits-list {
      list-style: none;
      margin: 2rem 0;
    }


    .benefits-list li {
      padding: 1rem 0;
      border-bottom: 1px solid var(--bege);
      display: flex;
      align-items: center;
      gap: 15px;
      font-size: 1.1rem;
    }


    .benefits-list li:last-child {
      border-bottom: none;
    }


    .security-note {
      text-align: center;
      color: var(--text-light);
      font-size: 0.9rem;
      margin-top: 2rem;
      padding: 1rem;
      background: var(--bege);
      border-radius: 10px;
    }


    /* Payment Methods */
    .payment-methods {
      background: var(--branco);
      border-radius: 20px;
      padding: 2.5rem;
      box-shadow: var(--shadow);
      border: 1px solid var(--lilas);
      position: sticky;
      top: 120px;
    }


    .payment-options {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin-bottom: 2rem;
    }


    .payment-option {
      background: var(--bege);
      padding: 1.5rem;
      border-radius: 15px;
      cursor: pointer;
      transition: var(--transition);
      border: 2px solid transparent;
      display: flex;
      align-items: center;
      gap: 15px;
    }


    .payment-option:hover {
      border-color: var(--lilas);
      transform: translateY(-2px);
    }


    .payment-option.selected {
      border-color: var(--vermelho-rosado);
      background: linear-gradient(135deg, #f8f0ff, var(--bege));
    }


    .payment-icon {
      font-size: 2rem;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--branco);
      border-radius: 12px;
    }


    .payment-info {
      flex: 1;
    }


    .payment-title {
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 0.3rem;
      color: var(--text);
    }


    .payment-desc {
      color: var(--text-light);
      font-size: 0.9rem;
    }


    /* Payment Simulation */
    .payment-simulation {
      display: none;
      background: var(--branco);
      border-radius: 15px;
      padding: 2rem;
      margin-top: 2rem;
      border: 2px solid var(--lilas);
      animation: fadeIn 0.3s ease;
    }


    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }


    .pix-container, .card-container {
      text-align: center;
    }


    .simulation-title {
      font-size: 1.4rem;
      color: var(--vermelho-rosado);
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }


    .pix-qr-code {
      background: linear-gradient(135deg, var(--bege), var(--branco));
      padding: 2.5rem;
      border-radius: 15px;
      margin: 1.5rem 0;
      border: 3px dashed var(--vermelho-rosado);
      position: relative;
    }


    .qr-placeholder {
      font-size: 4rem;
      margin-bottom: 1rem;
    }


    .qr-text {
      font-weight: 700;
      color: var(--text);
      margin-bottom: 0.5rem;
    }


    .qr-subtext {
      color: var(--text-light);
      font-size: 0.9rem;
    }


    .pix-code {
      background: var(--bege);
      padding: 1.2rem;
      border-radius: 10px;
      margin: 1.5rem 0;
      border: 1px solid var(--lilas);
      font-family: 'Courier New', monospace;
      word-break: break-all;
      font-size: 0.9rem;
      line-height: 1.4;
    }


    .copy-btn {
      background: var(--vermelho-rosado);
      color: white;
      border: none;
      padding: 0.8rem 1.5rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }


    .copy-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(209, 101, 109, 0.3);
    }


    .timer {
      font-size: 1.3rem;
      font-weight: bold;
      color: var(--vermelho-rosado);
      margin: 1.5rem 0;
      padding: 1rem;
      background: var(--bege);
      border-radius: 10px;
      border: 2px solid var(--lilas);
    }


    .card-form {
      text-align: left;
      max-width: 400px;
      margin: 0 auto;
    }


    .form-group {
      margin-bottom: 1.5rem;
    }


    .form-group label {
      display: block;
      margin-bottom: 0.8rem;
      font-weight: 600;
      color: var(--text);
    }


    .form-control {
      width: 100%;
      padding: 1rem;
      border: 2px solid var(--lilas);
      border-radius: 10px;
      font-size: 1rem;
      transition: var(--transition);
      background: var(--branco);
    }


    .form-control:focus {
      outline: none;
      border-color: var(--vermelho-rosado);
      box-shadow: 0 0 0 3px rgba(209, 101, 109, 0.1);
    }


    .card-row {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 1rem;
    }


    .test-cards {
      background: linear-gradient(135deg, var(--bege), #f8f0ff);
      padding: 1.5rem;
      border-radius: 12px;
      margin-top: 2rem;
      font-size: 0.9rem;
      border: 2px solid var(--lilas);
    }


    .test-cards strong {
      color: var(--vermelho-rosado);
      display: block;
      margin-bottom: 0.8rem;
      font-size: 1rem;
    }


    /* Loading */
    .loading {
      display: none;
      text-align: center;
      margin-top: 2rem;
      padding: 2rem;
    }


    .spinner {
      border: 4px solid var(--bege);
      border-top: 4px solid var(--vermelho-rosado);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 0 auto 1.5rem;
    }


    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }


    /* Footer */
    footer {
      background: linear-gradient(135deg, var(--vermelho-rosado), var(--lilas));
      color: var(--branco);
      padding: 2rem 0;
      margin-top: 3rem;
    }


    .footer-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2rem;
      margin-bottom: 2rem;
    }


    .footer-column h3 {
      margin-bottom: 1rem;
      font-size: 1.2rem;
    }


    .footer-column ul {
      list-style: none;
    }


    .footer-column ul li {
      margin-bottom: 0.5rem;
    }


    .footer-column a {
      color: var(--branco);
      text-decoration: none;
      opacity: 0.9;
      transition: var(--transition);
    }


    .footer-column a:hover {
      opacity: 1;
      text-decoration: underline;
    }


    .copyright {
      text-align: center;
      padding-top: 2rem;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
      opacity: 0.8;
    }


    /* Responsive */
    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
      }


      .logo img {
        height: 70px;
      }


      .checkout-grid {
        gap: 2rem;
      }


      .order-summary, .payment-methods {
        padding: 2rem;
      }


      .plan-price {
        font-size: 2rem;
      }


      .card-row {
        grid-template-columns: 1fr;
      }
    }


    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <img src="logoamorconect.png" alt="Amor Conect">
          <h1>Amor Conect</h1>
        </div>
        <a href="pricing.html" class="btn btn-outline">← Voltar para Planos</a>
      </div>
    </div>
  </header>


  <!-- Main Content -->
  <main class="main-content">
    <div class="container">
      <div class="checkout-grid">
        <!-- Order Summary -->
        <div class="order-summary">
          <h2 class="section-title"> Resumo do Pedido</h2>
          
          <div class="plan-selected">
            <div class="plan-name" id="planName">Plano Mensal</div>
            <div class="plan-price" id="planPrice">R$ 14,90</div>
            <div class="plan-period" id="planPeriod">por mês</div>
          </div>


          <h3 style="margin-bottom: 1rem; color: var(--vermelho-rosado); text-align: center;"> Benefícios Incluídos:</h3>
          <ul class="benefits-list">
            <li> Mensagens ilimitadas</li>
            <li> Histórico permanente</li>
            <li> Até 7 fotos no perfil</li>
            <li> Suporte prioritário (6h)</li>
            <li>️ Modo invisível</li>
            <li> Bloquear mensagens</li>
            <li> Ver visitantes do perfil</li>
          </ul>


          <div class="security-note">
             Pagamento 100% seguro via Mercado Pago | Ambiente de testes
          </div>
        </div>


        <!-- Payment Methods -->
        <div class="payment-methods">
          <h2 class="section-title"> Pagamento</h2>
          
          <div class="payment-options">
            <div class="payment-option selected" onclick="selectPayment('pix')">
              <div class="payment-icon"></div>
              <div class="payment-info">
                <div class="payment-title">PIX</div>
                <div class="payment-desc">Pagamento instantâneo • Aprovação imediata</div>
              </div>
            </div>


            <div class="payment-option" onclick="selectPayment('card')">
              <div class="payment-icon"></div>
              <div class="payment-info">
                <div class="payment-title">Cartão de Crédito</div>
                <div class="payment-desc">Até 12x sem juros • Débito também</div>
              </div>
            </div>
          </div>


          <button class="btn btn-primary" id="continueButton" onclick="showPaymentSimulation()" style="width: 100%; padding: 1.2rem;">
            ▶️ Continuar para Pagamento
          </button>


          <!-- PIX Simulation -->
          <div class="payment-simulation" id="pixSimulation">
            <div class="pix-container">
              <h3 class="simulation-title"> Pagamento PIX</h3>
              <p style="color: var(--text-light); margin-bottom: 1.5rem;">Escaneie o QR Code ou copie o código PIX</p>
              
              <div class="pix-qr-code">
                <div class="qr-placeholder"></div>
                <div class="qr-text">QR CODE SIMULADO</div>
                <div class="qr-subtext">Abra seu app de banco e escaneie</div>
              </div>


              <div class="pix-code" id="pixCode">
                00020126580014br.gov.bcb.pix0136123e4567-e89b-12d3-a456-426614174000520400005303986540614.905802BR5913AMOR CONECT6008BRASILIA62070503***6304A1A2
              </div>
              
              <button class="copy-btn" onclick="copyPixCode()">
                 Copiar Código PIX
              </button>


              <div class="timer" id="pixTimer">
                ⏳ Tempo restante: 29:59
              </div>


              <button class="btn btn-primary" onclick="simulatePixPayment()" style="width: 100%; padding: 1.2rem; margin-top: 1rem;">
                ✅ Simular Pagamento Concluído
              </button>


              <div style="margin-top: 1.5rem; font-size: 0.9rem; color: var(--text-light); text-align: center; padding: 1rem; background: var(--bege); border-radius: 8px;">
                 <strong>Para teste:</strong> Clique no botão acima para simular pagamento PIX concluído
              </div>
            </div>
          </div>


          <!-- Card Simulation -->
          <div class="payment-simulation" id="cardSimulation">
            <div class="card-container">
              <h3 class="simulation-title"> Pagamento com Cartão</h3>
              
              <div class="card-form">
                <div class="form-group">
                  <label>Número do Cartão</label>
                  <input type="text" class="form-control" id="cardNumber"
                      placeholder="1234 5678 9012 3456" maxlength="19">
                </div>


                <div class="card-row">
                  <div class="form-group">
                    <label>Validade</label>
                    <input type="text" class="form-control" id="cardExpiry"
                        placeholder="MM/AA" maxlength="5">
                  </div>
                  <div class="form-group">
                    <label>CVV</label>
                    <input type="text" class="form-control" id="cardCvv"
                        placeholder="123" maxlength="3">
                  </div>
                </div>


                <div class="form-group">
                  <label>Nome no Cartão</label>
                  <input type="text" class="form-control" id="cardName"
                      placeholder="SEU NOME AQUI">
                </div>


                <div class="form-group">
                  <label>CPF do Titular</label>
                  <input type="text" class="form-control" id="cardCpf"
                      placeholder="123.456.789-00">
                </div>
              </div>


              <div class="test-cards">
                <strong> Cartões para Teste (Mercado Pago Sandbox):</strong>
                • <strong>Cartão Aprovado:</strong> 5031 4332 1540 6351<br>
                • <strong>CVV:</strong> 123 | <strong>Validade:</strong> 11/25<br>
                • <strong>Nome:</strong> Qualquer | <strong>CPF:</strong> Qualquer
              </div>


              <button class="btn btn-primary" onclick="processCardPayment()" style="width: 100%; padding: 1.2rem; margin-top: 1.5rem;">
                 Finalizar Pagamento
              </button>
            </div>
          </div>


          <div class="loading" id="loading">
            <div class="spinner"></div>
            <p style="color: var(--text-light); font-size: 1.1rem;">Processando seu pagamento...</p>
          </div>
        </div>
      </div>
    </div>
  </main>


  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-column">
          <h3>Amor Conect</h3>
          <p>Uma plataforma segura e discreta para conectar corações e construir relacionamentos genuínos.</p>
        </div>
        <div class="footer-column">
          <h3>Links Rápidos</h3>
          <ul>
            <li><a href="home.html"> Home</a></li>
            <li><a href="pricing.html"> Planos</a></li>
            <li><a href="mensagens.html"> Mensagens</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h3>Suporte</h3>
          <ul>
            <li><a href="#"> Central de Ajuda</a></li>
            <li><a href="#"> Política de Privacidade</a></li>
            <li><a href="#"> Termos de Uso</a></li>
          </ul>
        </div>
      </div>
      <div class="copyright">
        <p>&copy; 2024 Amor Conect. Todos os direitos reservados.</p>
      </div>
    </div>
  </footer>


<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkout - Amor Conect</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://sdk.mercadopago.com/js/v2"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }


    :root {
      --bege: #f6ecc5;
      --vermelho-rosado: #d1656d;
      --lilas: #dfc9ed;
      --branco: #ffffff;
      --text: #444;
      --text-light: #666;
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      --transition: all 0.3s ease;
    }


    body {
      background-color: var(--bege);
      color: var(--text);
      line-height: 1.6;
    }


    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }


    /* Header */
    header {
      background: linear-gradient(135deg, var(--vermelho-rosado), var(--lilas));
      color: var(--branco);
      padding: 1rem 0;
      box-shadow: var(--shadow);
      position: sticky;
      top: 0;
      z-index: 100;
    }


    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }


    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }


    .logo img {
      height: 80px;
      width: auto;
      object-fit: contain;
    }


    .logo h1 {
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--branco);
    }


    .btn {
      padding: 0.8rem 2rem;
      border-radius: 30px;
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      text-decoration: none;
      display: inline-block;
      text-align: center;
      font-size: 1rem;
    }


    .btn-outline {
      background: transparent;
      border: 2px solid var(--branco);
      color: var(--branco);
    }


    .btn-primary {
      background: var(--vermelho-rosado);
      color: var(--branco);
      border: none;
    }


    .btn-secondary {
      background: transparent;
      border: 2px solid var(--vermelho-rosado);
      color: var(--vermelho-rosado);
    }


    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }


    /* Main Content */
    .main-content {
      padding: 3rem 0;
      min-height: calc(100vh - 200px);
    }


    .checkout-grid {
      display: grid;
      grid-template-columns: 1fr 400px;
      gap: 3rem;
      align-items: start;
    }


    @media (max-width: 968px) {
      .checkout-grid {
        grid-template-columns: 1fr;
      }
    }


    /* Order Summary */
    .order-summary {
      background: var(--branco);
      border-radius: 20px;
      padding: 2.5rem;
      box-shadow: var(--shadow);
      border: 1px solid var(--lilas);
    }


    .section-title {
      font-size: 1.8rem;
      color: var(--vermelho-rosado);
      margin-bottom: 2rem;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }


    .plan-selected {
      background: linear-gradient(135deg, var(--lilas), var(--bege));
      padding: 2rem;
      border-radius: 15px;
      margin-bottom: 2rem;
      text-align: center;
      border: 2px solid var(--lilas);
    }


    .plan-name {
      font-size: 1.6rem;
      color: var(--vermelho-rosado);
      margin-bottom: 0.5rem;
      font-weight: 700;
    }


    .plan-price {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 0.5rem;
      color: var(--text);
    }


    .plan-period {
      color: var(--text-light);
      font-size: 1.1rem;
    }


    .benefits-list {
      list-style: none;
      margin: 2rem 0;
    }


    .benefits-list li {
      padding: 1rem 0;
      border-bottom: 1px solid var(--bege);
      display: flex;
      align-items: center;
      gap: 15px;
      font-size: 1.1rem;
    }


    .benefits-list li:last-child {
      border-bottom: none;
    }


    .security-note {
      text-align: center;
      color: var(--text-light);
      font-size: 0.9rem;
      margin-top: 2rem;
      padding: 1rem;
      background: var(--bege);
      border-radius: 10px;
    }


    /* Payment Methods */
    .payment-methods {
      background: var(--branco);
      border-radius: 20px;
      padding: 2.5rem;
      box-shadow: var(--shadow);
      border: 1px solid var(--lilas);
      position: sticky;
      top: 120px;
    }


    .payment-options {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin-bottom: 2rem;
    }


    .payment-option {
      background: var(--bege);
      padding: 1.5rem;
      border-radius: 15px;
      cursor: pointer;
      transition: var(--transition);
      border: 2px solid transparent;
      display: flex;
      align-items: center;
      gap: 15px;
    }


    .payment-option:hover {
      border-color: var(--lilas);
      transform: translateY(-2px);
    }


    .payment-option.selected {
      border-color: var(--vermelho-rosado);
      background: linear-gradient(135deg, #f8f0ff, var(--bege));
    }


    .payment-icon {
      font-size: 2rem;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--branco);
      border-radius: 12px;
    }


    .payment-info {
      flex: 1;
    }


    .payment-title {
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 0.3rem;
      color: var(--text);
    }


    .payment-desc {
      color: var(--text-light);
      font-size: 0.9rem;
    }


    /* Payment Simulation */
    .payment-simulation {
      display: none;
      background: var(--branco);
      border-radius: 15px;
      padding: 2rem;
      margin-top: 2rem;
      border: 2px solid var(--lilas);
      animation: fadeIn 0.3s ease;
    }


    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }


    .pix-container, .card-container {
      text-align: center;
    }


    .simulation-title {
      font-size: 1.4rem;
      color: var(--vermelho-rosado);
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }


    .pix-qr-code {
      background: linear-gradient(135deg, var(--bege), var(--branco));
      padding: 2.5rem;
      border-radius: 15px;
      margin: 1.5rem 0;
      border: 3px dashed var(--vermelho-rosado);
      position: relative;
    }


    .qr-placeholder {
      font-size: 4rem;
      margin-bottom: 1rem;
    }


    .qr-text {
      font-weight: 700;
      color: var(--text);
      margin-bottom: 0.5rem;
    }


    .qr-subtext {
      color: var(--text-light);
      font-size: 0.9rem;
    }


    .pix-code {
      background: var(--bege);
      padding: 1.2rem;
      border-radius: 10px;
      margin: 1.5rem 0;
      border: 1px solid var(--lilas);
      font-family: 'Courier New', monospace;
      word-break: break-all;
      font-size: 0.9rem;
      line-height: 1.4;
    }


    .copy-btn {
      background: var(--vermelho-rosado);
      color: white;
      border: none;
      padding: 0.8rem 1.5rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }


    .copy-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(209, 101, 109, 0.3);
    }


    .timer {
      font-size: 1.3rem;
      font-weight: bold;
      color: var(--vermelho-rosado);
      margin: 1.5rem 0;
      padding: 1rem;
      background: var(--bege);
      border-radius: 10px;
      border: 2px solid var(--lilas);
    }


    .card-form {
      text-align: left;
      max-width: 400px;
      margin: 0 auto;
    }


    .form-group {
      margin-bottom: 1.5rem;
    }


    .form-group label {
      display: block;
      margin-bottom: 0.8rem;
      font-weight: 600;
      color: var(--text);
    }


    .form-control {
      width: 100%;
      padding: 1rem;
      border: 2px solid var(--lilas);
      border-radius: 10px;
      font-size: 1rem;
      transition: var(--transition);
      background: var(--branco);
    }


    .form-control:focus {
      outline: none;
      border-color: var(--vermelho-rosado);
      box-shadow: 0 0 0 3px rgba(209, 101, 109, 0.1);
    }


    .card-row {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 1rem;
    }


    .test-cards {
      background: linear-gradient(135deg, var(--bege), #f8f0ff);
      padding: 1.5rem;
      border-radius: 12px;
      margin-top: 2rem;
      font-size: 0.9rem;
      border: 2px solid var(--lilas);
    }


    .test-cards strong {
      color: var(--vermelho-rosado);
      display: block;
      margin-bottom: 0.8rem;
      font-size: 1rem;
    }


    /* Loading */
    .loading {
      display: none;
      text-align: center;
      margin-top: 2rem;
      padding: 2rem;
    }


    .spinner {
      border: 4px solid var(--bege);
      border-top: 4px solid var(--vermelho-rosado);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 0 auto 1.5rem;
    }


    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }


    /* Footer */
    footer {
      background: linear-gradient(135deg, var(--vermelho-rosado), var(--lilas));
      color: var(--branco);
      padding: 2rem 0;
      margin-top: 3rem;
    }


    .footer-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2rem;
      margin-bottom: 2rem;
    }


    .footer-column h3 {
      margin-bottom: 1rem;
      font-size: 1.2rem;
    }


    .footer-column ul {
      list-style: none;
    }


    .footer-column ul li {
      margin-bottom: 0.5rem;
    }


    .footer-column a {
      color: var(--branco);
      text-decoration: none;
      opacity: 0.9;
      transition: var(--transition);
    }


    .footer-column a:hover {
      opacity: 1;
      text-decoration: underline;
    }


    .copyright {
      text-align: center;
      padding-top: 2rem;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
      opacity: 0.8;
    }


    /* Responsive */
    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
      }


      .logo img {
        height: 70px;
      }


      .checkout-grid {
        gap: 2rem;
      }


      .order-summary, .payment-methods {
        padding: 2rem;
      }


      .plan-price {
        font-size: 2rem;
      }


      .card-row {
        grid-template-columns: 1fr;
      }
    }


    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <img src="logoamorconect.png" alt="Amor Conect">
          <h1>Amor Conect</h1>
        </div>
        <a href="pricing.html" class="btn btn-outline">← Voltar para Planos</a>
      </div>
    </div>
  </header>


  <!-- Main Content -->
  <main class="main-content">
    <div class="container">
      <div class="checkout-grid">
        <!-- Order Summary -->
        <div class="order-summary">
          <h2 class="section-title"> Resumo do Pedido</h2>
          
          <div class="plan-selected">
            <div class="plan-name" id="planName">Plano Mensal</div>
            <div class="plan-price" id="planPrice">R$ 14,90</div>
            <div class="plan-period" id="planPeriod">por mês</div>
          </div>


          <h3 style="margin-bottom: 1rem; color: var(--vermelho-rosado); text-align: center;"> Benefícios Incluídos:</h3>
          <ul class="benefits-list">
            <li> Mensagens ilimitadas</li>
            <li> Histórico permanente</li>
            <li> Até 7 fotos no perfil</li>
            <li> Suporte prioritário (6h)</li>
            <li>️ Modo invisível</li>
            <li> Bloquear mensagens</li>
            <li> Ver visitantes do perfil</li>
          </ul>


          <div class="security-note">
             Pagamento 100% seguro via Mercado Pago | Ambiente de testes
          </div>
        </div>


        <!-- Payment Methods -->
        <div class="payment-methods">
          <h2 class="section-title"> Pagamento</h2>
          
          <div class="payment-options">
            <div class="payment-option selected" onclick="selectPayment('pix')">
              <div class="payment-icon"></div>
              <div class="payment-info">
                <div class="payment-title">PIX</div>
                <div class="payment-desc">Pagamento instantâneo • Aprovação imediata</div>
              </div>
            </div>


            <div class="payment-option" onclick="selectPayment('card')">
              <div class="payment-icon"></div>
              <div class="payment-info">
                <div class="payment-title">Cartão de Crédito</div>
                <div class="payment-desc">Até 12x sem juros • Débito também</div>
              </div>
            </div>
          </div>


          <button class="btn btn-primary" id="continueButton" onclick="showPaymentSimulation()" style="width: 100%; padding: 1.2rem;">
            ▶️ Continuar para Pagamento
          </button>


          <!-- PIX Simulation -->
          <div class="payment-simulation" id="pixSimulation">
            <div class="pix-container">
              <h3 class="simulation-title"> Pagamento PIX</h3>
              <p style="color: var(--text-light); margin-bottom: 1.5rem;">Escaneie o QR Code ou copie o código PIX</p>
              
              <div class="pix-qr-code">
                <div class="qr-placeholder"></div>
                <div class="qr-text">QR CODE SIMULADO</div>
                <div class="qr-subtext">Abra seu app de banco e escaneie</div>
              </div>


              <div class="pix-code" id="pixCode">
                00020126580014br.gov.bcb.pix0136123e4567-e89b-12d3-a456-426614174000520400005303986540614.905802BR5913AMOR CONECT6008BRASILIA62070503***6304A1A2
              </div>
              
              <button class="copy-btn" onclick="copyPixCode()">
                 Copiar Código PIX
              </button>


              <div class="timer" id="pixTimer">
                ⏳ Tempo restante: 29:59
              </div>


              <button class="btn btn-primary" onclick="simulatePixPayment()" style="width: 100%; padding: 1.2rem; margin-top: 1rem;">
                ✅ Simular Pagamento Concluído
              </button>


              <div style="margin-top: 1.5rem; font-size: 0.9rem; color: var(--text-light); text-align: center; padding: 1rem; background: var(--bege); border-radius: 8px;">
                 <strong>Para teste:</strong> Clique no botão acima para simular pagamento PIX concluído
              </div>
            </div>
          </div>


          <!-- Card Simulation -->
          <div class="payment-simulation" id="cardSimulation">
            <div class="card-container">
              <h3 class="simulation-title"> Pagamento com Cartão</h3>
              
              <div class="card-form">
                <div class="form-group">
                  <label>Número do Cartão</label>
                  <input type="text" class="form-control" id="cardNumber"
                      placeholder="1234 5678 9012 3456" maxlength="19">
                </div>


                <div class="card-row">
                  <div class="form-group">
                    <label>Validade</label>
                    <input type="text" class="form-control" id="cardExpiry"
                        placeholder="MM/AA" maxlength="5">
                  </div>
                  <div class="form-group">
                    <label>CVV</label>
                    <input type="text" class="form-control" id="cardCvv"
                        placeholder="123" maxlength="3">
                  </div>
                </div>


                <div class="form-group">
                  <label>Nome no Cartão</label>
                  <input type="text" class="form-control" id="cardName"
                      placeholder="SEU NOME AQUI">
                </div>


                <div class="form-group">
                  <label>CPF do Titular</label>
                  <input type="text" class="form-control" id="cardCpf"
                      placeholder="123.456.789-00">
                </div>
              </div>


              <div class="test-cards">
                <strong> Cartões para Teste (Mercado Pago Sandbox):</strong>
                • <strong>Cartão Aprovado:</strong> 5031 4332 1540 6351<br>
                • <strong>CVV:</strong> 123 | <strong>Validade:</strong> 11/25<br>
                • <strong>Nome:</strong> Qualquer | <strong>CPF:</strong> Qualquer
              </div>


              <button class="btn btn-primary" onclick="processCardPayment()" style="width: 100%; padding: 1.2rem; margin-top: 1.5rem;">
                 Finalizar Pagamento
              </button>
            </div>
          </div>


          <div class="loading" id="loading">
            <div class="spinner"></div>
            <p style="color: var(--text-light); font-size: 1.1rem;">Processando seu pagamento...</p>
          </div>
        </div>
      </div>
    </div>
  </main>


  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-column">
          <h3>Amor Conect</h3>
          <p>Uma plataforma segura e discreta para conectar corações e construir relacionamentos genuínos.</p>
        </div>
        <div class="footer-column">
          <h3>Links Rápidos</h3>
          <ul>
            <li><a href="home.html"> Home</a></li>
            <li><a href="pricing.html"> Planos</a></li>
            <li><a href="mensagens.html"> Mensagens</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h3>Suporte</h3>
          <ul>
            <li><a href="#"> Central de Ajuda</a></li>
            <li><a href="#"> Política de Privacidade</a></li>
            <li><a href="#"> Termos de Uso</a></li>
          </ul>
        </div>
      </div>
      <div class="copyright">
        <p>&copy; 2024 Amor Conect. Todos os direitos reservados.</p>
      </div>
    </div>
  </footer>


 <script>
    // ==================== CONFIGURAÇÕES ====================
    const SUPABASE_URL = 'https://gcukalndarlgydmgmmmt.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdjdWthbG5kYXJsZ3lkbWdtbW10Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk2NzI1ODEsImV4cCI6MjA3NTI0ODU4MX0.S1Qt1UbmK-Jtq2dX7Aarf2rDLZhoLgEcSLkCrBfIhUU';
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    let selectedPlan = {};
    let selectedPayment = 'pix';
    let pixTimer = 30 * 60;
    let timerInterval;

    // ==================== INICIALIZAÇÃO ====================
    document.addEventListener('DOMContentLoaded', function() {
        loadPlanFromURL();
        checkAuth();
        setupCardInputs();
        
        // Verificação RPC melhorada (apenas para debug)
        setTimeout(async () => {
            const rpcAvailable = await checkRPCFunction();
            console.log(`🎯 Status RPC: ${rpcAvailable ? 'DISPONÍVEL' : 'NÃO DISPONÍVEL'}`);
        }, 2000);
    });

    function loadPlanFromURL() {
        const urlParams = new URLSearchParams(window.location.search);
        const planType = urlParams.get('plano');
        
        const plans = {
            'weekly': { name: 'Semanal', price: 4.90, period: 'por semana' },
            'monthly': { name: 'Mensal', price: 14.90, period: 'por mês' },
            'semestral': { name: 'Semestral', price: 74.90, period: 'por 6 meses' },
            'annual': { name: 'Anual', price: 129.90, period: 'por ano' }
        };

        selectedPlan = plans[planType] || plans['monthly'];
        
        document.getElementById('planName').textContent = `Plano ${selectedPlan.name}`;
        document.getElementById('planPrice').textContent = `R$ ${selectedPlan.price.toFixed(2).replace('.', ',')}`;
        document.getElementById('planPeriod').textContent = selectedPlan.period;
    }

    function selectPayment(method) {
        selectedPayment = method;
        document.querySelectorAll('.payment-option').forEach(option => {
            option.classList.remove('selected');
        });
        event.currentTarget.classList.add('selected');
    }

    function showPaymentSimulation() {
        const continueBtn = document.getElementById('continueButton');
        const pixSimulation = document.getElementById('pixSimulation');
        const cardSimulation = document.getElementById('cardSimulation');
        
        continueBtn.style.display = 'none';
        
        if (selectedPayment === 'pix') {
            pixSimulation.style.display = 'block';
            startPixTimer();
        } else {
            cardSimulation.style.display = 'block';
        }
    }

    // ==================== PIX SIMULATION ====================
    function startPixTimer() {
        pixTimer = 30 * 60;
        
        timerInterval = setInterval(() => {
            pixTimer--;
            const minutes = Math.floor(pixTimer / 60);
            const seconds = pixTimer % 60;
            
            document.getElementById('pixTimer').textContent =
                `⏳ Tempo restante: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            if (pixTimer <= 0) {
                clearInterval(timerInterval);
                alert('Tempo esgotado! Por favor, gere um novo código PIX.');
            }
        }, 1000);
    }

    function copyPixCode() {
        const pixCode = document.getElementById('pixCode').textContent;
        navigator.clipboard.writeText(pixCode).then(() => {
            alert('Código PIX copiado! Cole no seu app de banco.');
        });
    }

    // ==================== FUNÇÃO CORRIGIDA DE CRIAÇÃO DE ASSINATURA ====================
    async function createUserSubscription(paymentMethod) {
        try {
            console.log('🎯 INICIANDO CRIAÇÃO DE ASSINATURA...');
            
            const { data: { user }, error: authError } = await supabase.auth.getUser();
            if (authError || !user) {
                throw new Error('Usuário não autenticado');
            }

            console.log('👤 Usuário:', user.id);
            console.log('📦 Plano:', getPlanType());
            console.log('💳 Método:', paymentMethod);

            // ✅ CHAMADA DIRETA - SEM COMPLICAÇÕES
            const { data, error } = await supabase
                .rpc('create_user_subscription', {
                    p_user_id: user.id,
                    p_plan_name: getPlanType(),
                    p_payment_method: paymentMethod,
                    p_gateway: 'mercadopago',
                    p_gateway_transaction_id: 'mp_' + Date.now()
                });

            if (error) {
                console.error('❌ Erro na RPC:', error);
                throw new Error('Erro ao criar assinatura: ' + error.message);
            }

            console.log('✅ Resposta da RPC:', data);
            
            // ✅ VERIFICAÇÃO EXTRA - CONFIRMAR QUE VIROU PREMIUM
            console.log('🔄 Verificando atualização do perfil...');
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            const { data: updatedProfile } = await supabase
                .from('profiles')
                .select('is_premium, premium_expires_at')
                .eq('id', user.id)
                .single();
            console.log('🔍 Perfil após pagamento:', updatedProfile);
            
            return data;

        } catch (error) {
            console.error('❌ Erro geral:', error);
            throw new Error('Falha ao criar assinatura: ' + error.message);
        }
    }

    async function simulatePixPayment() {
        clearInterval(timerInterval);
        document.getElementById('loading').style.display = 'block';

        try {
            // ✅ CHAMAR FUNÇÃO CORRIGIDA
            await createUserSubscription('pix');
            
            setTimeout(() => {
                window.location.href = `pagamento-sucesso.html?plano=${getPlanType()}&valor=${selectedPlan.price}&metodo=pix`;
            }, 2000);
        } catch (error) {
            console.error('Erro no PIX:', error);
            alert('Erro ao processar PIX: ' + error.message);
            document.getElementById('loading').style.display = 'none';
        }
    }

    // ==================== CARD SIMULATION ====================
    function setupCardInputs() {
        document.getElementById('cardNumber').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/(\d{4})(?=\d)/g, '$1 ');
            e.target.value = value.substring(0, 19);
        });

        document.getElementById('cardExpiry').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length >= 2) {
                value = value.substring(0, 2) + '/' + value.substring(2, 4);
            }
            e.target.value = value.substring(0, 5);
        });

        document.getElementById('cardCvv').addEventListener('input', function(e) {
            e.target.value = e.target.value.replace(/\D/g, '').substring(0, 3);
        });

        document.getElementById('cardCpf').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 11) {
                value = value.replace(/(\d{3})(\d)/, '$1.$2')
                            .replace(/(\d{3})(\d)/, '$1.$2')
                            .replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            }
            e.target.value = value.substring(0, 14);
        });
    }

    async function processCardPayment() {
        const cardNumber = document.getElementById('cardNumber').value.replace(/\D/g, '');
        const cardExpiry = document.getElementById('cardExpiry').value;
        const cardCvv = document.getElementById('cardCvv').value;
        const cardName = document.getElementById('cardName').value;
        const cardCpf = document.getElementById('cardCpf').value.replace(/\D/g, '');

        if (!cardNumber || !cardExpiry || !cardCvv || !cardName || !cardCpf) {
            alert('Por favor, preencha todos os campos do cartão.');
            return;
        }

        document.getElementById('loading').style.display = 'block';

        try {
            // ✅ CHAMAR FUNÇÃO CORRIGIDA
            await createUserSubscription('credit_card');
            
            setTimeout(() => {
                window.location.href = `pagamento-sucesso.html?plano=${getPlanType()}&valor=${selectedPlan.price}&metodo=cartao`;
            }, 2000);
        } catch (error) {
            console.error('Erro no pagamento:', error);
            alert('Erro ao processar pagamento: ' + error.message);
            document.getElementById('loading').style.display = 'none';
        }
    }

    // ==================== FUNÇÕES AUXILIARES ====================
    async function checkAuth() {
        try {
            const { data: { user }, error } = await supabase.auth.getUser();
            if (error || !user) {
                window.location.href = 'login.html';
                return;
            }
        } catch (error) {
            console.error('Erro na autenticação:', error);
            window.location.href = 'login.html';
        }
    }

    function getPlanType() {
        for (const [key, value] of Object.entries({
            'weekly': { name: 'Semanal', price: 4.90 },
            'monthly': { name: 'Mensal', price: 14.90 },
            'semestral': { name: 'Semestral', price: 74.90 },
            'annual': { name: 'Anual', price: 129.90 }
        })) {
            if (value.price === selectedPlan.price) return key;
        }
        return 'monthly';
    }

    // ==================== VERIFICAÇÃO DE FUNÇÃO RPC CORRIGIDA ====================
    async function checkRPCFunction() {
        try {
            const { data: { user } } = await supabase.auth.getUser();
            if (!user) {
                console.log('ℹ️ Usuário não autenticado para teste RPC');
                return false;
            }

            console.log('🔍 Testando função RPC com usuário REAL:', user.id);
            
            const { error } = await supabase
                .rpc('create_user_subscription', {
                    p_user_id: user.id, // ✅ USA O USER ID REAL
                    p_plan_name: 'monthly',
                    p_payment_method: 'test',
                    p_gateway: 'mercadopago', // ✅ MERCADO PAGO REAL
                    p_gateway_transaction_id: 'mp_test_' + Date.now() // ✅ TRANSACTION ID REAL
                });

            if (error) {
                if (error.message.includes('function create_user_subscription')) {
                    console.log('❌ Função RPC não encontrada no Supabase');
                    return false;
                } else if (error.message.includes('Plano não encontrado')) {
                    console.log('✅ Função RPC EXISTE! (apenas erro de plano)');
                    return true;
                } else {
                    console.log('✅ Função RPC EXISTE! Erro:', error.message);
                    return true;
                }
            }
            
            console.log('✅ Função RPC disponível e funcionando!');
            return true;
            
        } catch (error) {
            console.log('ℹ️ Erro no teste RPC:', error.message);
            return false;
        }
    }

    // ==================== DEBUG - VERIFICAR STATUS ====================
    async function debugPremiumStatus() {
        try {
            const { data: { user } } = await supabase.auth.getUser();
            console.log('🔍 DEBUG - Usuário:', user?.id);
            
            // Verificar perfil atual
            const { data: profile } = await supabase
                .from('profiles')
                .select('is_premium, premium_expires_at')
                .eq('id', user.id)
                .single();
            console.log('🔍 DEBUG - Perfil atual:', profile);
            
            // Testar função RPC
            const { data: rpcTest, error: rpcError } = await supabase
                .rpc('is_user_premium', { user_uuid: user.id });
            console.log('🔍 DEBUG - RPC is_user_premium:', rpcTest, rpcError);
            
        } catch (error) {
            console.error('🔍 DEBUG - Erro:', error);
        }
    }

    // Para testar, adicione no console: debugPremiumStatus()
</script>
</body>
</html>